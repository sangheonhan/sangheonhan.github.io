<!DOCTYPE html>
<html lang="ko" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>PEAR: Log | Minimalist Programmer</title>
<meta name="keywords" content="PHP">
<meta name="description" content="기본사용법 대부분의 프로그래밍 언어는 여러 모듈과 라이브러리를 관리하기 위한 시스템을 가지고 있다. PHP는 PEAR(PHP Extension and Application Repository)라는 시스템을 가">
<meta name="author" content="Sangheon Han">
<link rel="canonical" href="https://sangheonhan.github.io/pear-log/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1740750342264a4e69b84ddf6899fb02cc95465080d85c57c08bb1d110900bf6.css" integrity="sha256-F0B1A0ImSk5puE3faJn7AsyVRlCA2FxXwIux0RCQC/Y=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://sangheonhan.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://sangheonhan.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://sangheonhan.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://sangheonhan.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://sangheonhan.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DSX13NGK68"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-DSX13NGK68', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="PEAR: Log" />
<meta property="og:description" content="기본사용법 대부분의 프로그래밍 언어는 여러 모듈과 라이브러리를 관리하기 위한 시스템을 가지고 있다. PHP는 PEAR(PHP Extension and Application Repository)라는 시스템을 가" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sangheonhan.github.io/pear-log/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-04-20T22:44:46&#43;00:00" />
<meta property="article:modified_time" content="2015-04-20T22:44:46&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="PEAR: Log"/>
<meta name="twitter:description" content="기본사용법 대부분의 프로그래밍 언어는 여러 모듈과 라이브러리를 관리하기 위한 시스템을 가지고 있다. PHP는 PEAR(PHP Extension and Application Repository)라는 시스템을 가"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://sangheonhan.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "PEAR: Log",
      "item": "https://sangheonhan.github.io/pear-log/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PEAR: Log",
  "name": "PEAR: Log",
  "description": "기본사용법 대부분의 프로그래밍 언어는 여러 모듈과 라이브러리를 관리하기 위한 시스템을 가지고 있다. PHP는 PEAR(PHP Extension and Application Repository)라는 시스템을 가",
  "keywords": [
    "PHP"
  ],
  "articleBody": "기본사용법 대부분의 프로그래밍 언어는 여러 모듈과 라이브러리를 관리하기 위한 시스템을 가지고 있다. PHP는 PEAR(PHP Extension and Application Repository)라는 시스템을 가지고 있는데, 현재는 컴포져(Composer)에 밀려나는 중이다. 모던 PHP(Modern PHP)를 위해서라도 컴포져를 쓰는 것이 더 좋겠지만, 때로 아직은 PEAR를 써야 할 일이 종종 있다. 물론 이 경우라도 컴포져를 통해서 PEAR를 사용하는 것을 적극 권장한다. 컴포져를 이용해 PEAR를 사용하는 방법은 컴포져 설명서에 자세히 나와있다.\nPHP를 설치하면 기본적으로 설치되는 PEAR 패키지가 몇개 있는데 Log도 그 중 하나다. 배포판에 따라 설치되지 않는 경우도 있지만, sudo pear install Log 명령을 통해서 간단히 설치 가능한다. 하지만 현재 Monolog가 쓰이는 경우가 더 많으므로, 새로운 프로젝트라면 그것을 쓰는 것을 더 추천하고 싶다.\n예제를 통해서 Log 패키지 사용법을 하나씩 살펴보자.\n1 2 3 4 5 6 7 \u003c?php require_once 'Log.php'; $logger = Log::factory('console', '', 'foobar'); $logger-\u003elog('Hello'); 1 require_once 'Log.php'; Log 패키지를 사용하기 위해서는 Log.php를 읽어들여야 하는데, PEAR를 통해서 설치했다면 보통 include_path로 잡혀있기 때문에 경로 없이 파일만 지정하면 된다. 컴포져를 통해서 설치했다면 vendor/autoload.php를 로드하면 된다.\n1 $logger = Log::factory('console', '', 'foobar'); Log 인스턴스를 하나 생성한다. 여기서는 Log::factory를 이용했다. 또 다른 방법으로 singleton 메소를 사용 할 수도 있는데, factory는 일반적으로 Log 인스턴스를 여럿 생성하기 위해 사용하고, singleton은 오직 하나의 Log 인스턴스만 생성하고 싶을 때 사용한다.\n1 Log::factory($handler, $name, $ident, $conf, $maxLevel); 첫번째 매개변수 console은 화면에 로그 메시지를 출력하는 핸들러 생성을 의미한다. 두번째는 로그 리소스의 이름으로 기본값은 빈 문자열이다. 여기서는 기본값을 그대로 사용했다. 세번째는 로그 파일 내에 기록되는 identification string으로 같은 로그 파일 내에 여러 종류의 로그 메시지들이 기록될 때 서로 구분하기 위해 사용하는 고유한 문자열이다. 네번째와 다섯번째는 핸들러 설정을 위한 배열과 기록 할 로그 레벨을 정하기 위한 값인데, 생략하면 기본값을 사용한다.\n1 $logger-\u003elog('Hello'); Log 인스턴스의 log 메소드를 통해서 로그 메시지를 기록한다. 두번째 메소드로 로그 레벨을 지정 할 수 있는데, 생략 할 경우 기본값인 PEAR_LOG_INFO를 로그 레벨로 사용한다.\nsingleton 메소드를 통해 Log 인스턴스를 생성하는 방법은 factory 메소드와 동일하지만, 둘의 차이는 singleton 경우는 여러번 인스턴스를 생성하더라도 오직 하나의 인스턴스를 생성한다는 점이다. 보통의 경우라면 factory 보다 singleton이 더 적절하다.\n1 $logger = Log::singleton('file', 'foobar.log', 'foobar'); singleton 메소드의 사용법은 factory 메소드와 동일하다. 다만, 여기서는 로그 핸들러를 console이 아닌 file을 사용했다. file 로그 핸들러를 사용하면 메시지를 텍스트 파일로 저장한다. 파일로 저장하기 때문에 두번째 매개변수에 로그 파일명이 들어간다.\n로그 레벨 로그 메시지에는 로그 레벨이란 것이 있는데, 대부분의 유닉스 계열의 로그 시스템에서 거의 동일하게 사용한다. Log에서도 마찬가지로 동일한 로그 레벨을 사용 중이고, Monolog, PSR-3, syslog를 사용한다고 해도 이 부분은 거의 같다.\nLog 사용자 문서에 나온 로그 레벨 표를 일단 한 번 살펴보자.\nLevel Shortcut Description PEAR_LOG_EMERG emerg() System is unusable PEAR_LOG_ALERT alert() Immediate action required PEAR_LOG_CRIT crit() Critical conditions PEAR_LOG_ERR err() Error conditions PEAR_LOG_WARNING warning() Warning conditions PEAR_LOG_NOTICE notice() Normal but significant PEAR_LOG_INFO info() Informational PEAR_LOG_DEBUG debug() Debug-level messages Level 값은 PEAR Log 패키지가 미리 정의한 값으로 log() 메소드 두번째 매개변수에 들어간다. 첨언하자면 PEAR_LOG_DEBUG가 가장 낮고, PEAR_LOG_EMERG가 가장 높은 레벨이다. 매번 log() 메소드에 로그 레벨 상수를 넣는 것이 번거롭다면 숏컷(Shortcut)을 사용 할 수도 있다.\n1 2 $logger-\u003elog('Hello', PEAR_LOG_DEBUG); $logger-\u003edebug('Hello'); // 위 문장과 동일하게 동작한다. 로그 레벨을 구별해서 기록하고 싶다면, Log 인스턴스를 생성 할 때 어느 로그 레벨 이상만 기록할지 지정 할 수 있다.\n1 $logger = Log::singleton('file', 'levels.log', 'factorial', null, PEAR_LOG_ERR); 5번째 매개변수에 로그 레벨 상수를 넣으면 해당 로그 레벨 이상인 메시지만 해당 로그 리소스에 기록한다.\n이미 생성한 Log 인스턴스를 특정 로그 레벨들만 기록하게 하고 싶다면 setMask() 메소드를 통해 로그 레벨을 지정하면 된다.\n1 2 $mask = Log::MASK(PEAR_LOG_WARNING) | Log::MASK(PEAR_LOG_INFO); $logger-\u003esetMask($mask); // Warning, Information 만 기록한다. 특정 로그 레벨 이상 또는 이하만 기록하고 싶다면 MAX(), MIN() 메소드를 이용한다.\n1 2 $mask = Log::MAX(PEAR_LOG_CRIT); // Critical 이상만 기록한다. $mask = Log::MIN(PEAR_LOG_NOTICE); // Notice 이하만 기록한다. 특정 로그 레벨을 제외한 나머지 로그 레벨들을 기록하려고 한다면 ^ 연산자를 이용해 마스크(Mask)를 지정한다.\n1 $mask = PEAR_LOG_ALL ^ Log::MASK(PEAR_LOG_WARNING); // Warning 뺀 나머지 로그 레벨들을 기록한다. Log 인스턴스에 특정 로그 레벨을 추가적으로 기록하고 싶다면 getMask() 메소드와 | 연산자를 이용해 마스크를 지정한다.\n1 2 // 기록 중인 로그 레벨과 더불어 Warning 도 기록하게 한다. $mask = $logger-\u003egetMask() | Log::MASK(PEAR_LOG_WARNING); 로그 라인 포맷 Log 인스턴스를 생성 할 때 설정값을 통해서 로그 라인의 형식을 기본 외의 형식으로 지정 할 수 있다. 형식에 사용하는 토큰은 다음과 같다.\nToken Alternate Description %{timestamp} %1$s Timestamp. This is often configurable. %{ident} %2$s The log handler’s identification string. %{priority} %3$s The log event’s priority. %{message} %4$s The log event’s message text. %{file} %5$s The full filename of the logging file. %{line} %6$s The line number on which the event occured. %{function} %7$s The function from which the event occurred. %{class} %8$s The class in which the event occurred. 토큰을 이용해 정의한 로그 라인 형식은 Log 인스턴스 생성시 설정값 매개변수에 lineFormat 첨자로 전달한다.\n1 2 3 4 5 $conf = array( 'lineFormat' =\u003e '%{timestamp} %{ident} %{priority} %{message} %{file} %{line} %{function} %{class}', ); $logger = Log::singleton('file', 'foobar.log', 'foobar', $conf); 로그 핸들러 Log 패키지에서 제공하는 다수의 로그 핸들러가 있다. 그 중 이전 글에서 다룬 console과 file 제외하고 몇개를 추려 간략한 사용법을 살펴보자.\nFirebug firebug 로그 핸들러는 파이어폭스(Firefox) Firebug 애드온의 콘솔 패널을 통해 로그 메시지를 출력하는 핸들러다.\n1 $logger = Log::singleton('firebug', '', 'foobar'); SQL sql 로그 핸들러는 데이터베이스에 로그 메시지를 기록한다. 데이터베이스 접근은 Log 패키지 안에서 PEAR DB를 이용한다. sql 핸들러를 사용하기 위해서는 로그를 저장 할 테이블을 미리 만들어야 한다. 기본값으로 사용하는 테이블 스키마는 다음과 같다.\n1 2 3 4 5 6 7 8 CREATE TABLE log_table ( id INT NOT NULL, logtime TIMESTAMP NOT NULL, ident CHAR(16) NOT NULL, priority INT NOT NULL, message VARCHAR(200), PRIMARY KEY (id) ); dsn은 사용하는 DBMS와 계정, 데이터베이스에 따라 설정한다. 자세한 형식은 DSN 문서에 나와있다.\n1 2 $conf = array('dsn' =\u003e 'mysql://bookworm@localhost/test'); $logger = Log::singleton('sql', 'log_table', 'foobar', $conf); Syslog syslog 핸들러는 syslog 데몬을 통해서 로그 메시지를 기록한다. 정상적으로 기록하기 위해서는 syslog 데몬 설정을 미리 해두어야 한다.\n1 $logger = Log::singleton('syslog', LOG_LOCAL0, 'foobar'); Window win 핸들러는 웹브라우저에 새 창을 만든 후 그 안에 로그 메시지를 출력한다.\n1 2 $conf = array('title' =\u003e 'Log Window'); $logger = Log::singleton('win', 'LogWindow', 'foobar', $conf); Composite composite 핸들러는 독립적으로 동작하지 않고, 다른 로그 핸들러를 통해서 메시지를 출력하도록 해준다. 이를 통해 여러 로그 리소스에 같은 메시지를 기록 할 수 있다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u003c?php require 'Log.php'; $console = Log::singleton('console', '', 'foobar'); $file = Log::singleton('file', 'foobar.log', 'foobar'); $logger = Log::singleton('composite'); $logger-\u003eaddChild($console); // console 로그 리소스를 composite 핸들러에 추가한다. $logger-\u003eaddChild($file); // file 로그 리소스를 composite 핸들러에 추가한다. $logger-\u003elog('Hello'); // console과 file 로그 둘 다 출력한다. $logger-\u003eremoveChild($console); $logger-\u003elog('Goodbye'); // console을 제거했기 때문에 file 로그에만 출력한다. 컴포져로 설치하기 컴포져(Composer)로 PEAR 패키지를 설치하는 일반적인 방법은 컴포져 설명서에 나와있으므로, 여기서는 Log 패키지에 한정해서 이야기를 해보려고 한다.\n패키지스트(Packagist)에 이미 pear/log가 있으므로 require로 손쉽게 설치 할 수 있었다. 하지만, 언젠가부터 의존성 문제로 설치가 되지 않는다. 이 문제를 해결하기 위해서는 composer.json에 dev-master 패키지를 설치하도록 설정해야 한다.\n1 2 3 4 5 6 { \"require\": { \"pear/log\": \"dev-master\", \"pear/pear_exception\": \"1.0.*@dev\" } } PEAR Log 의존성 문제를 없애기 위해 PEAR_Exception 패키지로 함께 설치하도록 설정했다.\n지금까지 PEAR의 Log 패키지에 대해 간략하게 다뤄보았다. 자세한 설정이나 기능에 대해서는 Log 패키지 문서를 통해 살펴 볼 수 있다.\n",
  "wordCount" : "2894",
  "inLanguage": "ko",
  "datePublished": "2015-04-20T22:44:46Z",
  "dateModified": "2015-04-20T22:44:46Z",
  "author":{
    "@type": "Person",
    "name": "Sangheon Han"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sangheonhan.github.io/pear-log/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Minimalist Programmer",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sangheonhan.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://sangheonhan.github.io/" accesskey="h" title="Minimalist Programmer (Alt + H)">Minimalist Programmer</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://sangheonhan.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://sangheonhan.github.io/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://sangheonhan.github.io/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://sangheonhan.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://sangheonhan.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      PEAR: Log
    </h1>
    <div class="post-meta"><span title='2015-04-20 22:44:46 +0000 +0000'>4월 20, 2015</span>&nbsp;·&nbsp;6 분&nbsp;·&nbsp;Sangheon Han

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">목차</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%ea%b8%b0%eb%b3%b8%ec%82%ac%ec%9a%a9%eb%b2%95" aria-label="기본사용법">기본사용법</a></li>
                <li>
                    <a href="#%eb%a1%9c%ea%b7%b8-%eb%a0%88%eb%b2%a8" aria-label="로그 레벨">로그 레벨</a></li>
                <li>
                    <a href="#%eb%a1%9c%ea%b7%b8-%eb%9d%bc%ec%9d%b8-%ed%8f%ac%eb%a7%b7" aria-label="로그 라인 포맷">로그 라인 포맷</a></li>
                <li>
                    <a href="#%eb%a1%9c%ea%b7%b8-%ed%95%b8%eb%93%a4%eb%9f%ac" aria-label="로그 핸들러">로그 핸들러</a><ul>
                        
                <li>
                    <a href="#firebug" aria-label="Firebug">Firebug</a></li>
                <li>
                    <a href="#sql" aria-label="SQL">SQL</a></li>
                <li>
                    <a href="#syslog" aria-label="Syslog">Syslog</a></li>
                <li>
                    <a href="#window" aria-label="Window">Window</a></li>
                <li>
                    <a href="#composite" aria-label="Composite">Composite</a></li></ul>
                </li>
                <li>
                    <a href="#%ec%bb%b4%ed%8f%ac%ec%a0%b8%eb%a1%9c-%ec%84%a4%ec%b9%98%ed%95%98%ea%b8%b0" aria-label="컴포져로 설치하기">컴포져로 설치하기</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="기본사용법">기본사용법<a hidden class="anchor" aria-hidden="true" href="#기본사용법">#</a></h2>
<p>대부분의 프로그래밍 언어는 여러 모듈과 라이브러리를 관리하기 위한 시스템을 가지고 있다. PHP는 <a href="http://pear.php.net/">PEAR(PHP Extension and Application Repository)</a>라는 시스템을 가지고 있는데, 현재는 <a href="https://getcomposer.org/">컴포져(Composer)</a>에 밀려나는 중이다. 모던 PHP(Modern PHP)를 위해서라도 컴포져를 쓰는 것이 더 좋겠지만, 때로 아직은 PEAR를 써야 할 일이 종종 있다. 물론 이 경우라도 컴포져를 통해서 PEAR를 사용하는 것을 적극 권장한다. 컴포져를 이용해 PEAR를 사용하는 방법은 <a href="http://xpressengine.github.io/Composer-korean-docs/">컴포져 설명서</a>에 자세히 나와있다.</p>
<p>PHP를 설치하면 기본적으로 설치되는 PEAR 패키지가 몇개 있는데 <a href="http://pear.php.net/package/Log/">Log</a>도 그 중 하나다. 배포판에 따라 설치되지 않는 경우도 있지만, <code>sudo pear install Log</code> 명령을 통해서 간단히 설치 가능한다. 하지만 현재 <a href="https://github.com/Seldaek/monolog">Monolog</a>가 쓰이는 경우가 더 많으므로, 새로운 프로젝트라면 그것을 쓰는 것을 더 추천하고 싶다.</p>
<p>예제를 통해서 <code>Log</code> 패키지 사용법을 하나씩 살펴보자.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">require_once</span> <span class="s1">&#39;Log.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="s1">&#39;console&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">require_once</span> <span class="s1">&#39;Log.php&#39;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Log 패키지를 사용하기 위해서는 <code>Log.php</code>를 읽어들여야 하는데, PEAR를 통해서 설치했다면 보통 <code>include_path</code>로 잡혀있기 때문에 경로 없이 파일만 지정하면 된다. 컴포져를 통해서 설치했다면 <code>vendor/autoload.php</code>를 로드하면 된다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="s1">&#39;console&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>Log</code> 인스턴스를 하나 생성한다. 여기서는 <code>Log::factory</code>를 이용했다. 또 다른 방법으로 <code>singleton</code> 메소를 사용 할 수도 있는데, <code>factory</code>는 일반적으로 <code>Log</code> 인스턴스를 여럿 생성하기 위해 사용하고, <code>singleton</code>은 오직 하나의 <code>Log</code> 인스턴스만 생성하고 싶을 때 사용한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">Log</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="nv">$handler</span><span class="p">,</span> <span class="nv">$name</span><span class="p">,</span> <span class="nv">$ident</span><span class="p">,</span> <span class="nv">$conf</span><span class="p">,</span> <span class="nv">$maxLevel</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>첫번째 매개변수 <code>console</code>은 화면에 로그 메시지를 출력하는 핸들러 생성을 의미한다. 두번째는 로그 리소스의 이름으로 기본값은 빈 문자열이다. 여기서는 기본값을 그대로 사용했다. 세번째는 로그 파일 내에 기록되는 <code>identification string</code>으로 같은 로그 파일 내에 여러 종류의 로그 메시지들이 기록될 때 서로 구분하기 위해 사용하는 고유한 문자열이다. 네번째와 다섯번째는 핸들러 설정을 위한 배열과 기록 할 로그 레벨을 정하기 위한 값인데, 생략하면 기본값을 사용한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>Log</code> 인스턴스의 <code>log</code> 메소드를 통해서 로그 메시지를 기록한다. 두번째 메소드로 로그 레벨을 지정 할 수 있는데, 생략 할 경우 기본값인 <code>PEAR_LOG_INFO</code>를 로그 레벨로 사용한다.</p>
<p><code>singleton</code> 메소드를 통해 <code>Log</code> 인스턴스를 생성하는 방법은 <code>factory</code> 메소드와 동일하지만, 둘의 차이는 <code>singleton</code> 경우는 여러번 인스턴스를 생성하더라도 오직 하나의 인스턴스를 생성한다는 점이다. 보통의 경우라면 <code>factory</code> 보다 <code>singleton</code>이 더 적절하다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar.log&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>singleton</code> 메소드의 사용법은 <code>factory</code> 메소드와 동일하다. 다만, 여기서는 로그 핸들러를 <code>console</code>이 아닌 <code>file</code>을 사용했다. <code>file</code> 로그 핸들러를 사용하면 메시지를 텍스트 파일로 저장한다. 파일로 저장하기 때문에 두번째 매개변수에 로그 파일명이 들어간다.</p>
<h2 id="로그-레벨">로그 레벨<a hidden class="anchor" aria-hidden="true" href="#로그-레벨">#</a></h2>
<p>로그 메시지에는 로그 레벨이란 것이 있는데, 대부분의 유닉스 계열의 로그 시스템에서 거의 동일하게 사용한다. Log에서도 마찬가지로 동일한 로그 레벨을 사용 중이고, <a href="https://github.com/Seldaek/monolog">Monolog</a>, <a href="http://www.php-fig.org/psr/psr-3/">PSR-3</a>, <code>syslog</code>를 사용한다고 해도 이 부분은 거의 같다.</p>
<p>Log 사용자 문서에 나온 로그 레벨 표를 일단 한 번 살펴보자.</p>
<table>
<thead>
<tr>
<th>Level</th>
<th>Shortcut</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PEAR_LOG_EMERG</td>
<td>emerg()</td>
<td>System is unusable</td>
</tr>
<tr>
<td>PEAR_LOG_ALERT</td>
<td>alert()</td>
<td>Immediate action required</td>
</tr>
<tr>
<td>PEAR_LOG_CRIT</td>
<td>crit()</td>
<td>Critical conditions</td>
</tr>
<tr>
<td>PEAR_LOG_ERR</td>
<td>err()</td>
<td>Error conditions</td>
</tr>
<tr>
<td>PEAR_LOG_WARNING</td>
<td>warning()</td>
<td>Warning conditions</td>
</tr>
<tr>
<td>PEAR_LOG_NOTICE</td>
<td>notice()</td>
<td>Normal but significant</td>
</tr>
<tr>
<td>PEAR_LOG_INFO</td>
<td>info()</td>
<td>Informational</td>
</tr>
<tr>
<td>PEAR_LOG_DEBUG</td>
<td>debug()</td>
<td>Debug-level messages</td>
</tr>
</tbody>
</table>
<p>Level 값은 PEAR Log 패키지가 미리 정의한 값으로 <code>log()</code> 메소드 두번째 매개변수에 들어간다. 첨언하자면 <code>PEAR_LOG_DEBUG</code>가 가장 낮고, <code>PEAR_LOG_EMERG</code>가 가장 높은 레벨이다. 매번 <code>log()</code> 메소드에 로그 레벨 상수를 넣는 것이 번거롭다면 숏컷(Shortcut)을 사용 할 수도 있다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="nx">PEAR_LOG_DEBUG</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">debug</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span> <span class="c1">// 위 문장과 동일하게 동작한다.
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>로그 레벨을 구별해서 기록하고 싶다면, Log 인스턴스를 생성 할 때 어느 로그 레벨 이상만 기록할지 지정 할 수 있다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;levels.log&#39;</span><span class="p">,</span> <span class="s1">&#39;factorial&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="nx">PEAR_LOG_ERR</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>5번째 매개변수에 로그 레벨 상수를 넣으면 해당 로그 레벨 이상인 메시지만 해당 로그 리소스에 기록한다.</p>
<p>이미 생성한 Log 인스턴스를 특정 로그 레벨들만 기록하게 하고 싶다면 <code>setMask()</code> 메소드를 통해 로그 레벨을 지정하면 된다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$mask</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">MASK</span><span class="p">(</span><span class="nx">PEAR_LOG_WARNING</span><span class="p">)</span> <span class="o">|</span> <span class="nx">Log</span><span class="o">::</span><span class="na">MASK</span><span class="p">(</span><span class="nx">PEAR_LOG_INFO</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">setMask</span><span class="p">(</span><span class="nv">$mask</span><span class="p">);</span> <span class="c1">// Warning, Information 만 기록한다.
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>특정 로그 레벨 이상 또는 이하만 기록하고 싶다면 <code>MAX()</code>, <code>MIN()</code> 메소드를 이용한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$mask</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">MAX</span><span class="p">(</span><span class="nx">PEAR_LOG_CRIT</span><span class="p">);</span> <span class="c1">// Critical 이상만 기록한다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$mask</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">MIN</span><span class="p">(</span><span class="nx">PEAR_LOG_NOTICE</span><span class="p">);</span> <span class="c1">// Notice 이하만 기록한다.
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>특정 로그 레벨을 제외한 나머지 로그 레벨들을 기록하려고 한다면 <code>^</code> 연산자를 이용해 마스크(Mask)를 지정한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$mask</span> <span class="o">=</span> <span class="nx">PEAR_LOG_ALL</span> <span class="o">^</span> <span class="nx">Log</span><span class="o">::</span><span class="na">MASK</span><span class="p">(</span><span class="nx">PEAR_LOG_WARNING</span><span class="p">);</span> <span class="c1">// Warning 뺀 나머지 로그 레벨들을 기록한다.
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Log 인스턴스에 특정 로그 레벨을 추가적으로 기록하고 싶다면 <code>getMask()</code> 메소드와 <code>|</code> 연산자를 이용해 마스크를 지정한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">// 기록 중인 로그 레벨과 더불어 Warning 도 기록하게 한다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$mask</span> <span class="o">=</span> <span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">getMask</span><span class="p">()</span> <span class="o">|</span> <span class="nx">Log</span><span class="o">::</span><span class="na">MASK</span><span class="p">(</span><span class="nx">PEAR_LOG_WARNING</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="로그-라인-포맷">로그 라인 포맷<a hidden class="anchor" aria-hidden="true" href="#로그-라인-포맷">#</a></h2>
<p>Log 인스턴스를 생성 할 때 설정값을 통해서 로그 라인의 형식을 기본 외의 형식으로 지정 할 수 있다. 형식에 사용하는 토큰은 다음과 같다.</p>
<table>
<thead>
<tr>
<th>Token</th>
<th>Alternate</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>%{timestamp}</td>
<td>%1$s</td>
<td>Timestamp. This is often configurable.</td>
</tr>
<tr>
<td>%{ident}</td>
<td>%2$s</td>
<td>The log handler&rsquo;s identification string.</td>
</tr>
<tr>
<td>%{priority}</td>
<td>%3$s</td>
<td>The log event&rsquo;s priority.</td>
</tr>
<tr>
<td>%{message}</td>
<td>%4$s</td>
<td>The log event&rsquo;s message text.</td>
</tr>
<tr>
<td>%{file}</td>
<td>%5$s</td>
<td>The full filename of the logging file.</td>
</tr>
<tr>
<td>%{line}</td>
<td>%6$s</td>
<td>The line number on which the event occured.</td>
</tr>
<tr>
<td>%{function}</td>
<td>%7$s</td>
<td>The function from which the event occurred.</td>
</tr>
<tr>
<td>%{class}</td>
<td>%8$s</td>
<td>The class in which the event occurred.</td>
</tr>
</tbody>
</table>
<p>토큰을 이용해 정의한 로그 라인 형식은 Log 인스턴스 생성시 설정값 매개변수에 <code>lineFormat</code> 첨자로 전달한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$conf</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;lineFormat&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;%{timestamp} %{ident} %{priority} %{message} %{file} %{line} %{function} %{class}&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar.log&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">,</span> <span class="nv">$conf</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="로그-핸들러">로그 핸들러<a hidden class="anchor" aria-hidden="true" href="#로그-핸들러">#</a></h2>
<p>Log 패키지에서 제공하는 다수의 로그 핸들러가 있다. 그 중 이전 글에서 다룬 <code>console</code>과 <code>file</code> 제외하고 몇개를 추려 간략한 사용법을 살펴보자.</p>
<h3 id="firebug">Firebug<a hidden class="anchor" aria-hidden="true" href="#firebug">#</a></h3>
<p><code>firebug</code> 로그 핸들러는 <a href="https://www.mozilla.org/">파이어폭스(Firefox)</a> <a href="http://getfirebug.com/">Firebug 애드온</a>의 콘솔 패널을 통해 로그 메시지를 출력하는 핸들러다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;firebug&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="sql">SQL<a hidden class="anchor" aria-hidden="true" href="#sql">#</a></h3>
<p><code>sql</code> 로그 핸들러는 데이터베이스에 로그 메시지를 기록한다. 데이터베이스 접근은 Log 패키지 안에서 <a href="http://pear.php.net/package/DB">PEAR DB</a>를 이용한다. <code>sql</code> 핸들러를 사용하기 위해서는 로그를 저장 할 테이블을 미리 만들어야 한다. 기본값으로 사용하는 테이블 스키마는 다음과 같다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">log_table</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w">          </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">logtime</span><span class="w">     </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ident</span><span class="w">       </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">priority</span><span class="w">    </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">message</span><span class="w">     </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>dsn</code>은 사용하는 DBMS와 계정, 데이터베이스에 따라 설정한다. 자세한 형식은 <a href="http://pear.php.net/manual/en/package.database.db.intro-dsn.php">DSN 문서</a>에 나와있다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$conf</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;dsn&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mysql://bookworm@localhost/test&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;sql&#39;</span><span class="p">,</span> <span class="s1">&#39;log_table&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">,</span> <span class="nv">$conf</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="syslog">Syslog<a hidden class="anchor" aria-hidden="true" href="#syslog">#</a></h3>
<p><code>syslog</code> 핸들러는 syslog 데몬을 통해서 로그 메시지를 기록한다. 정상적으로 기록하기 위해서는 syslog 데몬 설정을 미리 해두어야 한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;syslog&#39;</span><span class="p">,</span> <span class="nx">LOG_LOCAL0</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="window">Window<a hidden class="anchor" aria-hidden="true" href="#window">#</a></h3>
<p><code>win</code> 핸들러는 웹브라우저에 새 창을 만든 후 그 안에 로그 메시지를 출력한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$conf</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Log Window&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;win&#39;</span><span class="p">,</span> <span class="s1">&#39;LogWindow&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">,</span> <span class="nv">$conf</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="composite">Composite<a hidden class="anchor" aria-hidden="true" href="#composite">#</a></h3>
<p><code>composite</code> 핸들러는 독립적으로 동작하지 않고, 다른 로그 핸들러를 통해서 메시지를 출력하도록 해준다. 이를 통해 여러 로그 리소스에 같은 메시지를 기록 할 수 있다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;Log.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$console</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;console&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar.log&#39;</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">Log</span><span class="o">::</span><span class="na">singleton</span><span class="p">(</span><span class="s1">&#39;composite&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">addChild</span><span class="p">(</span><span class="nv">$console</span><span class="p">);</span> <span class="c1">// console 로그 리소스를 composite 핸들러에 추가한다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">addChild</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span> <span class="c1">// file 로그 리소스를 composite 핸들러에 추가한다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span> <span class="c1">// console과 file 로그 둘 다 출력한다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">removeChild</span><span class="p">(</span><span class="nv">$console</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">&#39;Goodbye&#39;</span><span class="p">);</span> <span class="c1">// console을 제거했기 때문에 file 로그에만 출력한다.
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="컴포져로-설치하기">컴포져로 설치하기<a hidden class="anchor" aria-hidden="true" href="#컴포져로-설치하기">#</a></h2>
<p><a href="https://getcomposer.org/">컴포져(Composer)</a>로 PEAR 패키지를 설치하는 일반적인 방법은 <a href="http://xpressengine.github.io/Composer-korean-docs/">컴포져 설명서</a>에 나와있으므로, 여기서는 Log 패키지에 한정해서 이야기를 해보려고 한다.</p>
<p><a href="https://packagist.org/">패키지스트(Packagist)</a>에 이미 <a href="https://packagist.org/packages/pear/log"><code>pear/log</code></a>가 있으므로 <code>require</code>로 손쉽게 설치 할 수 있었다. 하지만, 언젠가부터 의존성 문제로 설치가 되지 않는다. 이 문제를 해결하기 위해서는 <code>composer.json</code>에 <code>dev-master</code> 패키지를 설치하도록 설정해야 한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;require&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pear/log&#34;</span><span class="p">:</span> <span class="s2">&#34;dev-master&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;pear/pear_exception&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.*@dev&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>PEAR Log 의존성 문제를 없애기 위해 <a href="https://pear.php.net/package/PEAR_Exception">PEAR_Exception</a> 패키지로 함께 설치하도록 설정했다.</p>
<p>지금까지 PEAR의 <a href="https://pear.php.net/package/Log/">Log 패키지</a>에 대해 간략하게 다뤄보았다. 자세한 설정이나 기능에 대해서는 <a href="http://pear.github.io/Log/">Log 패키지 문서</a>를 통해 살펴 볼 수 있다.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://sangheonhan.github.io/tags/php/">PHP</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://sangheonhan.github.io/%EC%9A%B0%EB%B6%84%ED%88%AC-%EC%BB%A4%EB%84%90-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%ED%9B%84-virtualbox-%EC%8B%A4%ED%96%89-%EC%98%A4%EB%A5%98/">
    <span class="title">« 이전 페이지</span>
    <br>
    <span>우분투 커널 업데이트 후 VirtualBox 실행 오류</span>
  </a>
  <a class="next" href="https://sangheonhan.github.io/%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%ED%95%AD%EC%83%81-%EB%9D%84%EC%9B%8C%EB%86%93%EA%B8%B0/">
    <span class="title">다음 페이지 »</span>
    <br>
    <span>스크립트(프로세스) 항상 띄워놓기</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share PEAR: Log on twitter"
        href="https://twitter.com/intent/tweet/?text=PEAR%3a%20Log&amp;url=https%3a%2f%2fsangheonhan.github.io%2fpear-log%2f&amp;hashtags=PHP">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share PEAR: Log on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsangheonhan.github.io%2fpear-log%2f&amp;title=PEAR%3a%20Log&amp;summary=PEAR%3a%20Log&amp;source=https%3a%2f%2fsangheonhan.github.io%2fpear-log%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share PEAR: Log on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fsangheonhan.github.io%2fpear-log%2f&title=PEAR%3a%20Log">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share PEAR: Log on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsangheonhan.github.io%2fpear-log%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share PEAR: Log on whatsapp"
        href="https://api.whatsapp.com/send?text=PEAR%3a%20Log%20-%20https%3a%2f%2fsangheonhan.github.io%2fpear-log%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share PEAR: Log on telegram"
        href="https://telegram.me/share/url?text=PEAR%3a%20Log&amp;url=https%3a%2f%2fsangheonhan.github.io%2fpear-log%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://sangheonhan.github.io/">Minimalist Programmer</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '복사';

        function copyingDone() {
            copybutton.innerHTML = '복사 완료!';
            setTimeout(() => {
                copybutton.innerHTML = '복사';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
